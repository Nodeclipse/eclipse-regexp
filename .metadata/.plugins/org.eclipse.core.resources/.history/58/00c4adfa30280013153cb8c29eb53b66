package org.eclipse.regexp.ui.view;

import org.eclipse.jface.layout.GridDataFactory;
import org.eclipse.swt.SWT;
import org.eclipse.swt.layout.GridData;
import org.eclipse.swt.widgets.Composite;
import org.eclipse.swt.widgets.Control;
import org.eclipse.swt.widgets.Label;
import org.eclipse.swt.widgets.Text;
import org.eclipse.ui.ISharedImages;
import org.eclipse.ui.PlatformUI;
import org.eclipse.ui.forms.events.HyperlinkEvent;
import org.eclipse.ui.forms.events.IHyperlinkListener;
import org.eclipse.ui.forms.widgets.FormToolkit;
import org.eclipse.ui.forms.widgets.ImageHyperlink;

public class InputControl implements IHyperlinkListener {

	public interface HideListener {
		void onHide();
	}
	
	private final int index;

	public Label label;
	private Text input;
	private ImageHyperlink hideBtn;

	public InputControl(final int index) {
		this.index = index;
	}

	public void create(final Composite composite, final FormToolkit toolkit) {
		label = toolkit.createLabel(composite, "Input " + index + ":");
		GridDataFactory.swtDefaults().align(SWT.LEFT, SWT.CENTER)
				.applyTo(label);

		input = toolkit.createText(composite, "", SWT.SINGLE);
		GridDataFactory.swtDefaults().align(SWT.FILL, SWT.CENTER)
				.grab(true, false).applyTo(input);

		hideBtn = toolkit.createImageHyperlink(composite, SWT.NONE);
		hideBtn.setImage(PlatformUI.getWorkbench().getSharedImages()
				.getImage(ISharedImages.IMG_ETOOL_DELETE));
		hideBtn.addHyperlinkListener(this);
	}

	public void hide() {
		hide(label);
		hide(input);
		hide(hideBtn);
	}

	private void hide(final Control control) {
		final GridData data = (GridData) control.getLayoutData();
		data.exclude = true;
		control.setVisible(false);
	}

	@Override
	public void linkEntered(final HyperlinkEvent e) {
	}

	@Override
	public void linkExited(final HyperlinkEvent e) {
	}

	@Override
	public void linkActivated(final HyperlinkEvent e) {
		hide();
	}

}

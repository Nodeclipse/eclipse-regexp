package org.eclipse.regexp.ui.view.results;

import org.eclipse.jface.viewers.OwnerDrawLabelProvider;
import org.eclipse.jface.viewers.TableViewer;
import org.eclipse.regexp.RegexpResult;
import org.eclipse.swt.graphics.Point;
import org.eclipse.swt.widgets.Event;

public class ResultsOwnerDrawLabelProvider extends OwnerDrawLabelProvider {

	private final TableViewer viewer;

	public ResultsOwnerDrawLabelProvider(final TableViewer viewer) {
		this.viewer = viewer;
	}

	@Override
	protected void measure(final Event event, final Object element) {
		RegexpResult line = (RegexpResult) element;
		Point size = event.gc.textExtent(line.line);
		event.width = viewer.getTable().getColumn(event.index).getWidth();
		int lines = size.x / event.width + 1;
		event.height = size.y * lines;

	}

	@Override
	protected void paint(final Event event, final Object element) {
		LineEntry entry = (LineEntry) element;
		event.gc.drawText(entry.line, event.x, event.y, true);
	}
}
